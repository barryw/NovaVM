10 REM ================================
20 REM  BACH - INVENTION No. 13 IN A
30 REM  BWV 784 - SID CHIPTUNE
40 REM  NOVABASIC MML MUSIC ENGINE
50 REM ================================
60 PRINT CHR$(12)
70 MODE 1:COLOR 1,0:GCLS
80 REM -- SID INSTRUMENTS --
90 INSTRUMENT 1,64,0,6,5,4:REM PULSE HARPSICHORD
100 INSTRUMENT 2,64,1,8,6,4:REM PULSE BASS
110 REM -- VOICE 1: VOICEONE --
120 MUSIC 1,"T100I1O4L16REA>C<BEB>DC8E8<G#8>E8<AEA>C<BEB>DC8<A8R4R>ECE<A>C<EGF8A8>D8F8FD<B>D<GBDFE8G8>C8E8EC<A>C<F8>D8D<BGBE8>C8C<AFAD8B8>C8R8R4R<G>CED<G>DFE8G8<B8>G8C<G>CED<G>DFE8C8G8E8"
130 MUSIC 1,">C<AEACE<A>CD8F#8A8>C8<BGDG<B>D<GB>C8E8G8B8AF#D#F#<B>D#<F#AG8>G8GECE<A8>F#8F#D<B>D<G8>E8EC<A>C<F#>GF#ED#F#<B>D#E8R8R4RGB-GEGC#EGEC#E<ARR8R>FAFDF<B>DFD<B>D<GRR8R>EGECE<A>CD#C<A>C<F#RR8"
140 MUSIC 1,"R>DFD<B>D<G#B>D<BG#BERR8REA>C<BEB>DC8<A8G#8E8A>CEC<A>C<F#A>C<AF#AD#>C<BAG#B>D<BG#BDFG#FDF<B>FEDCEAECE<A>CD#C<A>C<F#>C<BAG#8>B8G#8E8REA>C<BEB>DC<A>CED<B>DFECEGFEDC<B>CDEFDG#DBDCAFD<B>D"
150 MUSIC 1,"<G#B>C<AEABG#AECE<A4"
160 REM -- VOICE 2: VOICETWO --
170 MUSIC 2,"I2O2L16A8>A4G#8AEA>C<BEB>DC8<A8G#8E8AEA>C<BEB>DC8<A8>C8<A8>D<AFADF<A>C<B8>D8G8B8BGEGCE<GBA8>C8DF<B>D<G8B8>CE<A>C<F8D8G>GFGCG>CED<G>DFE8C8<B8G8>C<G>CED<G>DFE8C8R4RGEGCE<GB"
180 MUSIC 2,"A8>C8E8G8F#ADF#<A>D<F#AG8B8>D8F#8EGCE<G>C<EGF#8A8B8>D#8RECE<A>CEGF#D<B>D<GB>DF#EC<A>C<F#A>C8C<B>C<AB8<B8>E>E<BGE<BGBE8>E8G8B-8C#8R8R>GFED8<D8F8A-8<B8R8RO4FEDC8<C8E8F#8<A8R8RO4ED#C#"
190 MUSIC 2,"<B8<B8>D8F8<G#8R8RO4DC<B>C8<A8G#8E8AEA>C<BEB>DCEAECE<A>C<F#A>C<AF#AD#F#E8G#8B8G#8E8<B8G#8E8A8>C8E8C8<A8>C8<D#8R8R>BG#EDBG#DC8E8<G#8>E8<A8>F#8<B8>G#8C8A8D8B-8G#8F8D8<B8G#8A8D8E8"
200 MUSIC 2,"F8D#8E8>E8<A2"
210 VOLUME 15
220 MUSIC PLAY
230 REM -- TITLE --
240 GCOLOR 14:LINE 10,6,309,6:LINE 10,7,309,7
250 COLOR 15,0:PRINT "    BACH - INVENTION No. 13 IN A"
260 COLOR 14,0:PRINT "           BWV 784"
270 REM -- KEY LOOKUP TABLES --
280 DIM KT(11),KI(11)
290 FOR I=0 TO 11:READ KT(I),KI(I):NEXT
300 DATA 0,0,1,0,0,1,1,1,0,2,0,3,1,3,0,4,1,4,0,5,1,5,0,6
310 REM -- KEYBOARD CONSTANTS --
320 KW=11:BW=7:KH=40:BH=24:SH=8
330 KX=6:Y1=36:Y2=90
340 MB=12:REM BASE MIDI C0
350 N1K=28:N2K=28
360 REM -- DRAW KEYBOARDS --
370 GCOLOR 1
380 FOR I=0 TO N1K-1:X=KX+I*KW:FILL X,Y1,X+KW-2,Y1+KH:NEXT I
390 FOR I=0 TO N2K-1:X=KX+I*KW:FILL X,Y2,X+KW-2,Y2+KH:NEXT I
400 GCOLOR 11
410 FOR I=0 TO N1K:X=KX+I*KW-1:LINE X,Y1,X,Y1+KH:NEXT I
420 FOR I=0 TO N2K:X=KX+I*KW-1:LINE X,Y2,X,Y2+KH:NEXT I
430 REM -- BLACK KEYS --
440 DIM BK(4):BK(0)=0:BK(1)=1:BK(2)=3:BK(3)=4:BK(4)=5
450 GCOLOR 0
460 FOR O=0 TO 3:FOR I=0 TO 4:X=KX+(O*7+BK(I))*KW+KW-BW/2
470 FILL X,Y1,X+BW-1,Y1+BH:NEXT I:NEXT O
480 FOR O=0 TO 3:FOR I=0 TO 4:X=KX+(O*7+BK(I))*KW+KW-BW/2
490 FILL X,Y2,X+BW-1,Y2+BH:NEXT I:NEXT O
500 REM -- OCTAVE LABELS --
510 COLOR 8,0
520 FOR O=0 TO 3:LOCATE 1+O*10,10:PRINT "C";:PRINT O;:NEXT O
530 FOR O=0 TO 3:LOCATE 1+O*10,17:PRINT "C";:PRINT O+4;:NEXT O
540 COLOR 10,0:LOCATE 1,18:PRINT "V1 VOICEONE";
550 COLOR 12,0:LOCATE 14,18:PRINT "V2 VOICETWO";
560 REM -- MAIN LOOP --
570 P1=0:P2=0
580 VSYNC
590 N1=MNOTE(1):N2=MNOTE(2)
600 REM -- UPDATE V1 --
610 IF N1=P1 THEN GOTO 650
620 IF P1>0 THEN S=P1:KC=1:BC=0:YO=25:GOSUB 740
630 IF N1>0 THEN S=N1:KC=10:BC=2:YO=25:GOSUB 740
640 P1=N1
650 REM -- UPDATE V2 --
660 IF N2=P2 THEN GOTO 700
670 IF P2>0 THEN S=P2:KC=1:BC=0:YO=33:GOSUB 740
680 IF N2>0 THEN S=N2:KC=12:BC=4:YO=33:GOSUB 740
690 P2=N2
700 IF PLAYING THEN GOTO 580
710 REM -- MUSIC FINISHED --
720 VOLUME 0:COLOR 7,0:LOCATE 1,24:PRINT " Finished.       ";
730 END
740 REM == HIGHLIGHT KEY ==
750 S=S-MB:IF S<0 OR S>95 THEN RETURN
760 OC=INT(S/12):PC=S-OC*12
770 T=KT(PC):W=KI(PC)
780 IF OC>3 THEN GOTO 850
790 REM UPPER ROW
800 IF T=1 THEN GOTO 830
810 X=KX+(OC*7+W)*KW:GCOLOR KC:FILL X+1,Y1+YO,X+KW-3,Y1+YO+SH-1
820 RETURN
830 X=KX+(OC*7+W)*KW+KW-BW/2:GCOLOR BC:FILL X+1,Y1+BH-SH,X+BW-2,Y1+BH-1
840 RETURN
850 REM LOWER ROW
860 OC=OC-4
870 IF T=1 THEN GOTO 900
880 X=KX+(OC*7+W)*KW:GCOLOR KC:FILL X+1,Y2+YO,X+KW-3,Y2+YO+SH-1
890 RETURN
900 X=KX+(OC*7+W)*KW+KW-BW/2:GCOLOR BC:FILL X+1,Y2+BH-SH,X+BW-2,Y2+BH-1
910 RETURN
