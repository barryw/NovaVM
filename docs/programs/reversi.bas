1 REM === REVERSI FOR NOVA BASIC ===
2 REM === FUN & GAMES SHOWCASE #1 ===
10 MODE 2:FONT 0:CLS:GCLS
11 DIM B(7,7),DX(7),DY(7)
12 DIM VM(63,2)
15 VOLUME 15
16 REM Board screen position
17 BL=24:BT=4
18 REM Colors: board bg, black piece, white piece
19 CB=5:C1=0:C2=1
20 REM Direction vectors for 8 directions
21 FOR I=0 TO 7:READ DX(I),DY(I):NEXT I
22 DATA -1,-1,0,-1,1,-1,-1,0,1,0,-1,1,0,1,1,1
23 CX=0:CY=0:REM Cursor position on board (0-7)
25 REM Draw green background fill
26 GCOLOR 5:FILL 0,0,319,199
30 FOR I=0 TO 15:SPRITEDATA 0,I,0,0,0,0,0,0,0,0:NEXT I
31 SPRITEDATA 0,0,$77,$77,$77,$77,$77,$77,$77,$77
32 SPRITEDATA 0,1,$70,$00,$00,$00,$00,$00,$00,$07
33 FOR I=2 TO 5:SPRITEDATA 0,I,$70,$00,$00,$00,$00,$00,$00,$07:NEXT I
34 SPRITEDATA 0,6,$70,$00,$00,$00,$00,$00,$00,$07
35 SPRITEDATA 0,7,$77,$77,$77,$77,$77,$77,$77,$77
36 SPRITESHAPE 0,0:SPRITE 0,ON
37 SPRITESET 0,6,2:REM Priority: in front
40 GOSUB 800:REM Title screen
50 REM === NEW GAME ===
51 FOR Y=0 TO 7:FOR X=0 TO 7:B(X,Y)=0:NEXT X:NEXT Y
52 B(3,3)=2:B(4,4)=2:REM White
53 B(3,4)=1:B(4,3)=1:REM Black
54 PT=1:REM Player turn: 1=black(human), 2=white(AI)
55 GOSUB 400:REM Draw board
56 GOSUB 450:GOSUB 950
57 GOSUB 530:GOSUB 550:GOSUB 959
58 GOSUB 460:REM Position cursor
100 REM === MAIN GAME LOOP ===
101 VSYNC
102 GET K
103 IF K=0 THEN GOTO 101
110 OX=CX:OY=CY
111 IF K=29 OR K=100 THEN CX=CX+1
112 IF K=28 OR K=97 THEN CX=CX-1
113 IF K=31 OR K=115 THEN CY=CY+1
114 IF K=30 OR K=119 THEN CY=CY-1
115 IF CX<0 THEN CX=7
116 IF CX>7 THEN CX=0
117 IF CY<0 THEN CY=7
118 IF CY>7 THEN CY=0
120 GOSUB 460:REM Update cursor sprite
125 IF K<>32 AND K<>13 THEN GOTO 130
126 REM Check if cursor is on a legal move
127 MX=CX:MY=CY:GOSUB 500
128 IF NF=0 THEN GOTO 130
129 GOSUB 565:REM Clear move markers
131 GOSUB 600:REM Execute the move
132 GOSUB 900:REM Play placement sound
133 GOSUB 950:REM Update score
134 REM Switch turns
135 PT=3-PT
136 GOSUB 530:REM Find legal moves for next player
137 IF NV=0 THEN PT=3-PT:GOSUB 530:REM Pass — switch back
138 IF NV=0 THEN GOTO 700:REM Both pass — game over
139 GOSUB 550:REM Display new valid moves
140 GOSUB 959:REM Update turn display
141 IF PT=2 THEN GOTO 300
130 GOTO 101
300 REM === AI TURN ===
301 GOSUB 959:REM Show "AI THINKING.."
302 REM Brief thinking delay
303 FOR W=1 TO 30:VSYNC:NEXT W
304 REM Find best move (most flips)
305 BM=0:BF=VM(0,2)
306 FOR I=1 TO NV-1
307 IF VM(I,2)<=BF THEN GOTO 310
308 BF=VM(I,2):BM=I
310 NEXT I
312 REM Corner bonus: always prefer corners
313 FOR I=0 TO NV-1
314 VX=VM(I,0):VY=VM(I,1)
315 IF (VX=0 OR VX=7) AND (VY=0 OR VY=7) THEN BM=I:GOTO 320
316 NEXT I
320 REM Move cursor to chosen cell for visual feedback
321 CX=VM(BM,0):CY=VM(BM,1)
322 GOSUB 460:REM Move cursor sprite
323 FOR W=1 TO 15:VSYNC:NEXT W
324 REM Execute the move
325 GOSUB 565:REM Clear move markers
326 MX=CX:MY=CY:GOSUB 600
327 GOSUB 910:REM Play AI move sound
328 GOSUB 950:REM Update score
329 REM Switch to player
330 PT=3-PT
331 GOSUB 530:REM Find player's legal moves
332 IF NV=0 THEN PT=3-PT:GOSUB 530:REM Player must pass
333 IF NV=0 THEN GOTO 700:REM Both pass — game over
334 GOSUB 550:REM Show valid moves
335 GOSUB 959:REM Show "YOUR TURN"
340 GOTO 101:REM Back to main loop
400 REM === DRAW BOARD ===
401 COLOR 7,0
402 REM Column labels
403 FOR I=0 TO 7
404 LOCATE BL+1+I*4,BT-1:PRINT CHR$(65+I);
405 NEXT I
406 REM Top border
407 LOCATE BL,BT:PRINT CHR$(218);
408 FOR I=0 TO 6:PRINT CHR$(196);CHR$(196);CHR$(196);CHR$(194);:NEXT I
409 PRINT CHR$(196);CHR$(196);CHR$(196);CHR$(191);
410 REM Board rows
411 FOR R=0 TO 7
412 REM Row with cells
413 LOCATE BL,BT+1+R*2
414 PRINT CHR$(179);
415 FOR C=0 TO 7
416 PRINT "   ";
417 IF C<7 THEN PRINT CHR$(179);
418 NEXT C
419 PRINT CHR$(179);
420 REM Row label
421 LOCATE BL-2,BT+1+R*2:PRINT STR$(R+1);
422 REM Separator (except after last row)
423 IF R=7 THEN GOTO 440
424 LOCATE BL,BT+2+R*2
425 PRINT CHR$(195);
426 FOR I=0 TO 6:PRINT CHR$(196);CHR$(196);CHR$(196);CHR$(197);:NEXT I
427 PRINT CHR$(196);CHR$(196);CHR$(196);CHR$(180);
430 NEXT R
440 REM Bottom border
441 LOCATE BL,BT+16
442 PRINT CHR$(192);
443 FOR I=0 TO 6:PRINT CHR$(196);CHR$(196);CHR$(196);CHR$(193);:NEXT I
444 PRINT CHR$(196);CHR$(196);CHR$(196);CHR$(217);
445 REM Color the board cells green
446 FOR R=0 TO 7:FOR C=0 TO 7
447 SY=BT+1+R*2:SX=BL+1+C*4
448 FOR I=0 TO 2:POKE 45520+SY*80+SX+I,CB*16+CB:NEXT I
449 NEXT C:NEXT R:RETURN
460 REM === UPDATE CURSOR SPRITE POSITION ===
461 QX=BL*4+4+CX*16:QY=BT*8+8+CY*16
462 SPRITE 0,QX,QY
465 RETURN
450 REM === RENDER ALL PIECES ===
452 FOR RR=0 TO 7:FOR CC=0 TO 7
453 GOSUB 470:REM Render single cell
454 NEXT CC:NEXT RR
455 RETURN
470 REM === RENDER CELL (CC,RR) ===
471 SY=BT+1+RR*2:SX=BL+1+CC*4
472 P=B(CC,RR)
473 IF P=0 THEN PC=CB:PA=32:GOTO 478
474 IF P=1 THEN PC=C1:PA=254:GOTO 478
475 PC=C2:PA=254
478 REM Write center character
479 POKE 43520+SY*80+SX+1,PA
480 REM Set color: piece foreground on green background
481 POKE 45520+SY*80+SX+1,PC*16+CB
485 RETURN
500 REM === CHECK SINGLE MOVE (MX,MY) FOR PLAYER PT ===
501 REM Input: MX,MY=position, PT=current player
502 REM Output: NF=total pieces that would flip
503 NF=0
504 IF B(MX,MY)<>0 THEN RETURN
505 OP=3-PT:REM Opponent
506 FOR D=0 TO 7
507 NX=MX+DX(D):NY=MY+DY(D):DF=0
508 IF NX<0 OR NX>7 OR NY<0 OR NY>7 THEN GOTO 518
509 IF B(NX,NY)<>OP THEN GOTO 518
510 REM Walk in this direction
511 DF=DF+1:NX=NX+DX(D):NY=NY+DY(D)
512 IF NX<0 OR NX>7 OR NY<0 OR NY>7 THEN GOTO 518
513 IF B(NX,NY)=OP THEN GOTO 511
514 IF B(NX,NY)=PT THEN NF=NF+DF
518 NEXT D
520 RETURN
530 REM === FIND ALL LEGAL MOVES FOR PLAYER PT ===
531 REM Output: NV=count, VM(i,0)=x, VM(i,1)=y, VM(i,2)=flips
532 NV=0
533 FOR MY=0 TO 7:FOR MX=0 TO 7
534 GOSUB 500
535 IF NF=0 THEN GOTO 539
536 VM(NV,0)=MX:VM(NV,1)=MY:VM(NV,2)=NF
537 NV=NV+1
539 NEXT MX:NEXT MY
540 RETURN
550 REM === DISPLAY VALID MOVES AS MARKERS ===
551 FOR I=0 TO NV-1
552 VX=VM(I,0):VY=VM(I,1)
553 SY=BT+1+VY*2:SX=BL+1+VX*4+1
554 POKE 43520+SY*80+SX,250:REM CHR$(250) = middle dot
555 POKE 45520+SY*80+SX,12*16+CB:REM Medium grey on green
556 NEXT I
560 RETURN
565 REM === CLEAR VALID MOVE MARKERS ===
566 FOR I=0 TO NV-1
567 VX=VM(I,0):VY=VM(I,1)
568 IF B(VX,VY)<>0 THEN GOTO 572
569 SY=BT+1+VY*2:SX=BL+1+VX*4+1
570 POKE 43520+SY*80+SX,32:REM Space
571 POKE 45520+SY*80+SX,CB*16+CB:REM Green on green
572 NEXT I
575 RETURN
600 REM === EXECUTE MOVE (MX,MY) FOR PLAYER PT ===
601 B(MX,MY)=PT:OP=3-PT:FL=0
602 FOR D=0 TO 7
603 NX=MX+DX(D):NY=MY+DY(D)
604 IF NX<0 OR NX>7 OR NY<0 OR NY>7 THEN GOTO 625
605 IF B(NX,NY)<>OP THEN GOTO 625
606 REM Walk to find our piece
607 FX=NX:FY=NY:DF=1
608 FX=FX+DX(D):FY=FY+DY(D)
609 IF FX<0 OR FX>7 OR FY<0 OR FY>7 THEN GOTO 625
610 IF B(FX,FY)=OP THEN DF=DF+1:GOTO 608
611 IF B(FX,FY)<>PT THEN GOTO 625
612 REM Flip all opponent pieces in this direction
613 FX=NX:FY=NY
614 B(FX,FY)=PT:FL=FL+1
615 SY=BT+1+FY*2:SX=BL+1+FX*4+1
616 POKE 45520+SY*80+SX,2*16+CB:REM Red flash
617 FX=FX+DX(D):FY=FY+DY(D)
618 IF B(FX,FY)=OP THEN GOTO 614
625 NEXT D
626 FOR W=1 TO 8:VSYNC:NEXT W
627 GOSUB 450:REM Re-render all pieces
630 RETURN
700 REM === GAME OVER (placeholder) ===
701 LOCATE 62,14:PRINT "GAME OVER"
702 GOTO 702
800 REM === TITLE SCREEN (placeholder) ===
801 LOCATE 30,12:PRINT "R E V E R S I"
802 LOCATE 28,14:PRINT "Press any key to play"
803 GET K:IF K=0 THEN 803
804 CLS
810 RETURN
900 REM === PLACEMENT SOUND ===
901 SOUND 72,3
905 RETURN
910 REM === AI MOVE SOUND ===
911 SOUND 60,3
915 RETURN
950 REM === UPDATE SCORE DISPLAY ===
951 S1=0:S2=0
952 FOR YY=0 TO 7:FOR XX=0 TO 7
953 IF B(XX,YY)=1 THEN S1=S1+1
954 IF B(XX,YY)=2 THEN S2=S2+1
955 NEXT XX:NEXT YY
956 COLOR 1,0
957 LOCATE 62,6:PRINT "BLACK: ";S1;" "
958 LOCATE 62,8:PRINT "WHITE: ";S2;" "
959 LOCATE 62,10
960 IF PT=1 THEN PRINT "YOUR TURN    "
961 IF PT=2 THEN PRINT "AI THINKING.."
965 RETURN
